---
phase: 07-nx-monorepo-restructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - nx.json
  - package.json
  - apps/web/project.json
  - apps/web/package.json
  - libs/ui/project.json
  - libs/ui/package.json
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "Nx workspace initialized at repo root with nx.json"
    - "apps/web/ exists as empty Nx project scaffold"
    - "libs/ui/ exists as empty Nx project scaffold"
    - "npx nx show projects lists web and ui projects"
  artifacts:
    - path: "nx.json"
      provides: "Nx workspace configuration"
      contains: "namedInputs"
    - path: "apps/web/project.json"
      provides: "Frontend app Nx project definition"
      contains: "\"name\": \"web\""
    - path: "apps/web/package.json"
      provides: "Minimal frontend package descriptor"
      contains: "\"name\": \"web\""
    - path: "libs/ui/project.json"
      provides: "UI library Nx project definition"
      contains: "\"name\": \"ui\""
  key_links:
    - from: "nx.json"
      to: "apps/web/project.json"
      via: "Nx project discovery (scans for project.json files)"
      pattern: "\"name\": \"web\""
    - from: "nx.json"
      to: "libs/ui/project.json"
      via: "Nx project discovery (scans for project.json files)"
      pattern: "\"name\": \"ui\""
---

<objective>
Initialize the Nx monorepo workspace and scaffold the empty frontend and UI library projects.

Purpose: Establish the Nx workspace foundation before any file moves. This creates the monorepo structure that subsequent plans will populate with moved backend code and extracted domain library.

Output: Working Nx workspace with `nx.json` at root, empty `apps/web/` and `libs/ui/` scaffolds with `project.json` files.
</objective>

<execution_context>
@/home/developer/.claude/get-shit-done/workflows/execute-plan.md
@/home/developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-nx-monorepo-restructure/07-CONTEXT.md
@.planning/phases/07-nx-monorepo-restructure/07-RESEARCH.md
@package.json
@.gitignore
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Nx workspace</name>
  <files>nx.json, package.json, .gitignore, .nxignore</files>
  <action>
  Install Nx as a dev dependency and initialize the workspace:

  1. Run `npm install --save-dev nx@latest` to add Nx to the project
  2. Create `nx.json` at repo root with this configuration:
     ```json
     {
       "$schema": "./node_modules/nx/schemas/nx-schema.json",
       "namedInputs": {
         "default": ["{projectRoot}/**/*", "sharedGlobals"],
         "sharedGlobals": [],
         "production": ["default", "!{projectRoot}/tests/**/*", "!{projectRoot}/**/*.test.*"]
       },
       "targetDefaults": {
         "test": {
           "cache": true
         },
         "lint": {
           "cache": true
         }
       }
     }
     ```
  3. Update `.gitignore` to add `.nx/` directory (Nx cache)
  4. Create `.nxignore` at repo root with:
     ```
     .planning/
     .venv/
     .git/
     .hypothesis/
     __pycache__/
     ```
  5. Do NOT run `nx init` interactively -- manual setup is cleaner for this project since we're adding Nx to an existing non-JS project.
  </action>
  <verify>
  - `cat nx.json` shows valid configuration
  - `npx nx --version` prints Nx version
  - `grep '.nx/' .gitignore` confirms cache directory excluded
  </verify>
  <done>Nx workspace initialized with nx.json, Nx installed as devDependency, .gitignore updated</done>
</task>

<task type="auto">
  <name>Task 2: Scaffold apps/web/ and libs/ui/ as empty Nx projects</name>
  <files>apps/web/project.json, apps/web/package.json, libs/ui/project.json, libs/ui/package.json</files>
  <action>
  Create the empty frontend and UI library scaffolds per user decisions:

  1. Create `apps/web/` directory structure:
     - `apps/web/project.json`:
       ```json
       {
         "name": "web",
         "projectType": "application",
         "sourceRoot": "apps/web/src",
         "targets": {}
       }
       ```
     - `apps/web/package.json`:
       ```json
       {
         "name": "web",
         "version": "0.0.0",
         "private": true
       }
       ```

  2. Create `libs/ui/` directory structure:
     - `libs/ui/project.json`:
       ```json
       {
         "name": "ui",
         "projectType": "library",
         "sourceRoot": "libs/ui/src",
         "targets": {}
       }
       ```
     - `libs/ui/package.json`:
       ```json
       {
         "name": "ui",
         "version": "0.0.0",
         "private": true
       }
       ```

  3. These are intentionally minimal -- Phase 8 (Frontend Infrastructure) will add React, Tailwind, shadcn/ui dependencies. The `project.json` establishes them as Nx-managed projects now.
  </action>
  <verify>
  - `npx nx show projects` lists both "web" and "ui"
  - `cat apps/web/project.json` shows valid project config
  - `cat libs/ui/project.json` shows valid project config
  - Directories exist: `ls apps/web/ libs/ui/`
  </verify>
  <done>apps/web/ and libs/ui/ scaffolded as empty Nx projects discoverable by `nx show projects`</done>
</task>

</tasks>

<verification>
- `npx nx show projects` includes "web" and "ui"
- `npx nx --version` works
- nx.json exists with valid configuration
- No existing tests broken (no code moved yet)
</verification>

<success_criteria>
- Nx workspace initialized at repo root
- apps/web/ exists as registered Nx project
- libs/ui/ exists as registered Nx project
- All existing tests still pass (nothing moved yet)
</success_criteria>

<output>
After completion, create `.planning/phases/07-nx-monorepo-restructure/07-01-SUMMARY.md`
</output>
