---
phase: 12-frontend-infrastructure
plan: 03
type: execute
wave: 3
depends_on: ["12-02"]
files_modified:
  - apps/web/src/styles/globals.css
  - apps/web/postcss.config.js
  - apps/web/src/main.tsx
  - apps/web/index.html
  - eslint.config.mjs
  - .prettierrc
  - .prettierignore
  - apps/web/project.json
autonomous: true

must_haves:
  truths:
    - "Tailwind CSS v4 utility classes apply in the browser (e.g., bg-primary, text-foreground)"
    - "Dark mode toggle works (class 'dark' on html switches color scheme)"
    - "Inter font renders for UI text, JetBrains Mono renders for monospace"
    - "ESLint catches TypeScript errors in .tsx files"
    - "Prettier formats .tsx files consistently"
  artifacts:
    - path: "apps/web/src/styles/globals.css"
      provides: "Tailwind CSS v4 theme with dark mode variables"
      contains: "@import \"tailwindcss\""
    - path: "apps/web/postcss.config.js"
      provides: "PostCSS config for Tailwind v4"
      contains: "@tailwindcss/postcss"
    - path: "eslint.config.mjs"
      provides: "ESLint 9 flat config with TypeScript strict + React"
      contains: "tseslint"
    - path: ".prettierrc"
      provides: "Prettier configuration"
  key_links:
    - from: "apps/web/src/main.tsx"
      to: "apps/web/src/styles/globals.css"
      via: "CSS import"
      pattern: "import.*globals.css"
    - from: "apps/web/postcss.config.js"
      to: "tailwindcss"
      via: "PostCSS plugin"
      pattern: "@tailwindcss/postcss"
---

<objective>
Configure Tailwind CSS v4 with CSS-first theming, self-hosted Inter and JetBrains Mono fonts, dark mode infrastructure, and set up ESLint 9 with Prettier for frontend code quality.

Purpose: Establish the styling foundation (Tailwind v4 + fonts + dark mode) and linting infrastructure that all components and features will use.
Output: Working Tailwind v4 with custom theme, dark mode CSS variables, self-hosted fonts, ESLint flat config, and Prettier formatting.
</objective>

<execution_context>
@/home/developer/.claude/get-shit-done/workflows/execute-plan.md
@/home/developer/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-frontend-infrastructure/12-CONTEXT.md
@.planning/phases/12-frontend-infrastructure/12-RESEARCH.md
@.planning/phases/12-frontend-infrastructure/12-01-SUMMARY.md
@.planning/phases/12-frontend-infrastructure/12-02-SUMMARY.md
@apps/web/vite.config.ts
@apps/web/tsconfig.json
@tsconfig.base.json
@apps/web/src/main.tsx
@nx.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Tailwind CSS v4 + PostCSS + Fonts + Dark Mode</name>
  <files>
    apps/web/src/styles/globals.css
    apps/web/postcss.config.js
    apps/web/src/main.tsx
    apps/web/index.html
  </files>
  <action>
    1. Install Tailwind CSS v4 and PostCSS plugin:
       ```bash
       cd /workspace && pnpm add -D tailwindcss @tailwindcss/postcss postcss
       ```
    2. Install self-hosted fonts via Fontsource:
       ```bash
       cd /workspace/apps/web && pnpm add @fontsource/inter @fontsource/jetbrains-mono
       ```
    3. Create `apps/web/postcss.config.js`:
       ```javascript
       module.exports = {
         plugins: {
           '@tailwindcss/postcss': {},
         },
       };
       ```
    4. Create `apps/web/src/styles/globals.css` with Tailwind v4 CSS-first config:
       ```css
       @import "tailwindcss";

       /* Finance-appropriate color palette using CSS variables */
       /* Uses shadcn/ui compatible variable naming for future component integration */

       @theme {
         --font-sans: "Inter", system-ui, -apple-system, sans-serif;
         --font-mono: "JetBrains Mono", ui-monospace, monospace;
       }

       /* Light mode (default) */
       :root {
         --background: 0 0% 100%;
         --foreground: 222.2 84% 4.9%;
         --card: 0 0% 100%;
         --card-foreground: 222.2 84% 4.9%;
         --popover: 0 0% 100%;
         --popover-foreground: 222.2 84% 4.9%;
         --primary: 221.2 83.2% 53.3%;
         --primary-foreground: 210 40% 98%;
         --secondary: 210 40% 96.1%;
         --secondary-foreground: 222.2 47.4% 11.2%;
         --muted: 210 40% 96.1%;
         --muted-foreground: 215.4 16.3% 46.9%;
         --accent: 210 40% 96.1%;
         --accent-foreground: 222.2 47.4% 11.2%;
         --destructive: 0 84.2% 60.2%;
         --destructive-foreground: 210 40% 98%;
         --success: 142.1 76.2% 36.3%;
         --success-foreground: 210 40% 98%;
         --warning: 38 92% 50%;
         --warning-foreground: 222.2 84% 4.9%;
         --border: 214.3 31.8% 91.4%;
         --input: 214.3 31.8% 91.4%;
         --ring: 221.2 83.2% 53.3%;
         --radius: 0.5rem;
         --sidebar-width: 16rem;
         --sidebar-width-collapsed: 4rem;
       }

       /* Dark mode */
       .dark {
         --background: 222.2 84% 4.9%;
         --foreground: 210 40% 98%;
         --card: 222.2 84% 4.9%;
         --card-foreground: 210 40% 98%;
         --popover: 222.2 84% 4.9%;
         --popover-foreground: 210 40% 98%;
         --primary: 217.2 91.2% 59.8%;
         --primary-foreground: 222.2 47.4% 11.2%;
         --secondary: 217.2 32.6% 17.5%;
         --secondary-foreground: 210 40% 98%;
         --muted: 217.2 32.6% 17.5%;
         --muted-foreground: 215 20.2% 65.1%;
         --accent: 217.2 32.6% 17.5%;
         --accent-foreground: 210 40% 98%;
         --destructive: 0 62.8% 30.6%;
         --destructive-foreground: 210 40% 98%;
         --success: 142.1 70.6% 45.3%;
         --success-foreground: 222.2 84% 4.9%;
         --warning: 38 92% 50%;
         --warning-foreground: 222.2 84% 4.9%;
         --border: 217.2 32.6% 17.5%;
         --input: 217.2 32.6% 17.5%;
         --ring: 224.3 76.3% 48%;
       }

       /* Base styles */
       * {
         border-color: hsl(var(--border));
       }

       body {
         background-color: hsl(var(--background));
         color: hsl(var(--foreground));
         font-family: var(--font-sans);
       }

       /* Financial figures use monospace font */
       .font-mono {
         font-family: var(--font-mono);
       }

       /* Negative amounts: red text per user decision */
       .amount-negative {
         color: hsl(var(--destructive));
       }
       ```
    5. Update `apps/web/src/main.tsx` to import fonts and global CSS:
       ```typescript
       import { StrictMode } from 'react';
       import { createRoot } from 'react-dom/client';

       // Self-hosted fonts
       import '@fontsource/inter/400.css';
       import '@fontsource/inter/500.css';
       import '@fontsource/inter/600.css';
       import '@fontsource/inter/700.css';
       import '@fontsource/jetbrains-mono/400.css';
       import '@fontsource/jetbrains-mono/700.css';

       // Global styles (Tailwind v4 + theme)
       import './styles/globals.css';

       import { App } from './app/app';

       const root = document.getElementById('root');
       if (!root) throw new Error('Root element not found');

       createRoot(root).render(
         <StrictMode>
           <App />
         </StrictMode>
       );
       ```
    6. Update `apps/web/src/app/app.tsx` to demonstrate Tailwind + fonts + dark mode:
       ```typescript
       import { useEffect, useState } from 'react';

       export function App() {
         const [isDark, setIsDark] = useState(false);

         useEffect(() => {
           const stored = localStorage.getItem('theme');
           if (stored === 'dark' || (!stored && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
             setIsDark(true);
             document.documentElement.classList.add('dark');
           }
         }, []);

         const toggleTheme = () => {
           const next = !isDark;
           setIsDark(next);
           document.documentElement.classList.toggle('dark', next);
           localStorage.setItem('theme', next ? 'dark' : 'light');
         };

         return (
           <div className="min-h-screen bg-background text-foreground p-8">
             <div className="max-w-2xl mx-auto space-y-6">
               <div className="flex items-center justify-between">
                 <h1 className="text-3xl font-bold text-primary">Personal Finance</h1>
                 <button
                   onClick={toggleTheme}
                   className="px-4 py-2 rounded-md bg-secondary text-secondary-foreground hover:bg-accent transition-colors"
                 >
                   {isDark ? 'Light' : 'Dark'} Mode
                 </button>
               </div>
               <p className="text-muted-foreground">App is running with Tailwind CSS v4.</p>
               <div className="font-mono text-lg">
                 <span>Balance: </span>
                 <span className="text-success-foreground">$1,234.56</span>
                 <span className="mx-4">|</span>
                 <span className="amount-negative">-$50.00</span>
               </div>
             </div>
           </div>
         );
       }
       ```
    7. Update `apps/web/index.html` to include dark mode class support:
       ```html
       <!DOCTYPE html>
       <html lang="en" class="">
         <head>
           <meta charset="UTF-8" />
           <meta name="viewport" content="width=device-width, initial-scale=1.0" />
           <title>Personal Finance</title>
           <script>
             // Prevent flash of wrong theme
             if (localStorage.theme === 'dark' || (!localStorage.theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
               document.documentElement.classList.add('dark');
             }
           </script>
         </head>
         <body>
           <div id="root"></div>
           <script type="module" src="/src/main.tsx"></script>
         </body>
       </html>
       ```
    8. Verify: `npx nx serve web` -- page shows styled content with Inter font, dark mode toggle works, monospace numbers visible

    NOTE: The CSS variables use HSL values without the hsl() wrapper. This is the shadcn/ui convention -- components use `hsl(var(--primary))` to reference them. This pattern enables opacity modifiers like `bg-primary/50`.

    Color palette rationale: Slate base with blue primary -- professional, trustworthy for finance. Green for success (positive amounts), red/destructive for negative amounts per user decision.
  </action>
  <verify>
    - `npx nx serve web` renders styled page with Tailwind utilities
    - Dark mode toggle switches between light and dark themes
    - Inter font visible in body text (check browser dev tools computed style)
    - JetBrains Mono visible in .font-mono elements
    - Negative amount shows in red
    - No PostCSS or Tailwind build errors
  </verify>
  <done>Tailwind CSS v4 with CSS-first @theme, dark mode CSS variables, Inter + JetBrains Mono self-hosted fonts, and PostCSS configured.</done>
</task>

<task type="auto">
  <name>Task 2: ESLint 9 flat config + Prettier</name>
  <files>
    eslint.config.mjs
    .prettierrc
    .prettierignore
  </files>
  <action>
    1. Install ESLint 9, TypeScript ESLint, React plugins, and Prettier at workspace root:
       ```bash
       cd /workspace && pnpm add -D eslint @eslint/js typescript-eslint eslint-plugin-react eslint-plugin-react-hooks eslint-config-prettier prettier
       ```
    2. Create `eslint.config.mjs` at workspace root:
       ```javascript
       import js from '@eslint/js';
       import tseslint from 'typescript-eslint';
       import reactPlugin from 'eslint-plugin-react';
       import reactHooks from 'eslint-plugin-react-hooks';
       import prettier from 'eslint-config-prettier';

       export default tseslint.config(
         // Global ignores
         {
           ignores: [
             'dist/**',
             'node_modules/**',
             'coverage/**',
             '*.config.{js,mjs,cjs}',
             'apps/api/**',
             'libs/domain/**',
           ],
         },
         // Base recommended rules
         js.configs.recommended,
         // TypeScript strict rules
         ...tseslint.configs.strict,
         // React configuration
         {
           files: ['**/*.{ts,tsx}'],
           plugins: {
             react: reactPlugin,
             'react-hooks': reactHooks,
           },
           languageOptions: {
             parserOptions: {
               ecmaFeatures: { jsx: true },
             },
           },
           settings: {
             react: {
               version: 'detect',
             },
           },
           rules: {
             ...reactPlugin.configs.recommended.rules,
             ...reactHooks.configs.recommended.rules,
             'react/react-in-jsx-scope': 'off',
             'react/prop-types': 'off',
           },
         },
         // Prettier must be last to disable conflicting formatting rules
         prettier,
       );
       ```
       NOTE: Exclude apps/api/ and libs/domain/ (Python projects) from ESLint scope. ESLint is frontend-only.
       NOTE: Start without `strictTypeChecked` (requires project reference in parserOptions). Use `strict` preset which doesn't need type-aware linting. Can upgrade later if needed.
    3. Create `.prettierrc` at workspace root:
       ```json
       {
         "semi": true,
         "singleQuote": true,
         "trailingComma": "all",
         "printWidth": 100,
         "tabWidth": 2,
         "arrowParens": "always"
       }
       ```
    4. Create `.prettierignore` at workspace root:
       ```
       dist
       coverage
       node_modules
       pnpm-lock.yaml
       apps/api
       libs/domain
       *.py
       ```
    5. Verify ESLint works on the app file:
       ```bash
       npx eslint apps/web/src/app/app.tsx
       ```
    6. Verify Prettier works:
       ```bash
       npx prettier --check "apps/web/src/**/*.{ts,tsx}"
       ```
    7. If Prettier reports formatting issues, fix them:
       ```bash
       npx prettier --write "apps/web/src/**/*.{ts,tsx}"
       ```

    IMPORTANT: ESLint flat config uses `eslint.config.mjs` (not `.eslintrc`). The `tseslint.config()` wrapper provides type-safe configuration.
  </action>
  <verify>
    - `npx eslint apps/web/src/app/app.tsx` runs without errors (or only warnings)
    - `npx prettier --check "apps/web/src/**/*.{ts,tsx}"` passes
    - No `.eslintrc` file exists (using flat config only)
    - ESLint ignores Python files (apps/api, libs/domain)
  </verify>
  <done>ESLint 9 with TypeScript strict + React plugins and Prettier configured. Frontend code quality gates ready.</done>
</task>

</tasks>

<verification>
1. `npx nx serve web` shows styled page with Tailwind utilities, fonts, dark mode toggle
2. `npx eslint apps/web/src/` runs without errors
3. `npx prettier --check "apps/web/src/**/*.{ts,tsx}"` passes
4. Dark mode toggle switches theme (localStorage persisted)
5. JetBrains Mono renders for financial figures
6. PostCSS processes Tailwind v4 @import correctly
</verification>

<success_criteria>
- Tailwind CSS v4 with CSS-first configuration working
- Dark mode CSS variables with class-based toggle
- Inter and JetBrains Mono self-hosted fonts loading
- ESLint 9 flat config linting TypeScript + React
- Prettier formatting enforced
- shadcn/ui compatible CSS variable naming convention established
</success_criteria>

<output>
After completion, create `.planning/phases/12-frontend-infrastructure/12-03-SUMMARY.md`
</output>
