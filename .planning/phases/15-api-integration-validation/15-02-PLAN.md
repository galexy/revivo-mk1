---
phase: 15-api-integration-validation
plan: 02
type: execute
wave: 2
depends_on: ["15-01"]
files_modified:
  - apps/web/src/features/accounts/components/EmptyAccountsState.tsx
  - apps/web/src/features/accounts/components/AccountSidebar.tsx
  - apps/web/src/features/accounts/components/AccountListItem.tsx
  - apps/web/src/features/accounts/components/AccountGroupHeader.tsx
  - apps/web/src/features/accounts/types.ts
  - apps/web/src/features/accounts/utils.ts
autonomous: true

must_haves:
  truths:
    - "Empty state shows centered welcome prompt with illustration and prominent Add Account button"
    - "Sidebar renders account groups (Cash, Credit, Loans, Investments, Rewards) with headers showing subtotals"
    - "Each account shows name + formatted balance"
    - "Group headers show category name + subtotal balance"
  artifacts:
    - path: "apps/web/src/features/accounts/components/EmptyAccountsState.tsx"
      provides: "Zero-accounts welcome screen"
      min_lines: 20
    - path: "apps/web/src/features/accounts/components/AccountSidebar.tsx"
      provides: "Left sidebar with grouped accounts"
      min_lines: 30
    - path: "apps/web/src/features/accounts/components/AccountListItem.tsx"
      provides: "Single account row (name + balance)"
      min_lines: 15
    - path: "apps/web/src/features/accounts/utils.ts"
      provides: "Account grouping utility function"
  key_links:
    - from: "apps/web/src/features/accounts/components/AccountSidebar.tsx"
      to: "apps/web/src/features/accounts/utils.ts"
      via: "groupAccounts function"
      pattern: "groupAccounts"
---

<objective>
Design the empty state welcome screen and account sidebar layout with grouping, using the frontend-design skill for visual quality.

Purpose: Visual-first design of two key views (empty state + sidebar) before wiring functionality.
Output: Polished, static components with mock data that look production-ready.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/CHECKPOINTS.md
@.planning/phases/15-api-integration-validation/15-CONTEXT.md
@.planning/phases/15-api-integration-validation/15-RESEARCH.md
@apps/web/src/pages/DashboardPage.tsx
@apps/web/src/lib/api-client.ts
@libs/ui/src/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create account feature types, utils, and empty state component</name>
  <files>
    apps/web/src/features/accounts/types.ts
    apps/web/src/features/accounts/utils.ts
    apps/web/src/features/accounts/components/EmptyAccountsState.tsx
  </files>
  <action>
    Use the `frontend-design` skill for high-quality visual output. Research existing shadcn/ui patterns before implementing.

    1. Create `apps/web/src/features/accounts/types.ts`:
       - AccountCategory type: 'cash' | 'credit' | 'loans' | 'investments' | 'rewards'
       - AccountGroup interface: { category: AccountCategory; label: string; accounts: AccountResponse[]; subtotal: number }
       - Import AccountResponse from @/lib/api-client

    2. Create `apps/web/src/features/accounts/utils.ts`:
       - `ACCOUNT_CATEGORIES` mapping: record mapping AccountCategory to { label: string, types: AccountType[] }
         - cash: ['checking', 'savings'] label "Cash"
         - credit: ['credit_card'] label "Credit"
         - loans: ['loan'] label "Loans"
         - investments: ['brokerage', 'ira'] label "Investments"
         - rewards: ['rewards'] label "Rewards"
       - `groupAccounts(accounts: AccountResponse[]): AccountGroup[]` -- groups accounts by category, computes subtotal from current_balance.amount, filters out empty groups
       - `formatCurrency(amount: string | number): string` -- formats as USD with Intl.NumberFormat (e.g., "$1,234.56")

    3. Create `apps/web/src/features/accounts/components/EmptyAccountsState.tsx`:
       - Centered layout taking full height of the content area
       - Simple Lucide icon (Wallet or CircleDollarSign from lucide-react -- check if lucide-react is installed, if not use inline SVG)
       - Heading: "Welcome to Personal Finance"
       - Subtext: "Add your first account to get started tracking your finances."
       - Prominent "Add Your First Account" button using shadcn Button (size="lg")
       - The button calls an `onAddAccount` prop (callback, not wired to wizard yet)
       - Clean, modern aesthetic matching the app's dark/light theme
       - NO roadmap teasing, NO mention of transactions or future features

    Verify: `npx nx typecheck web`
  </action>
  <verify>`npx nx typecheck web` passes.</verify>
  <done>
    EmptyAccountsState renders a visually polished welcome screen with "Add Your First Account" button.
    Account grouping utility correctly groups accounts by category and computes subtotals.
  </done>
</task>

<task type="auto">
  <name>Task 2: Design account sidebar with groups, items, and context menu</name>
  <files>
    apps/web/src/features/accounts/components/AccountGroupHeader.tsx
    apps/web/src/features/accounts/components/AccountListItem.tsx
    apps/web/src/features/accounts/components/AccountSidebar.tsx
  </files>
  <action>
    Use the `frontend-design` skill for high-quality visual output. These components render with STATIC mock data for now. Functionality (click handlers, real data) comes in Plan 04.

    1. Create `apps/web/src/features/accounts/components/AccountGroupHeader.tsx`:
       - Shows category label (e.g., "Cash", "Credit") and subtotal balance
       - Clickable to collapse/expand the group (internal state, no localStorage yet)
       - Subtle chevron icon indicating collapsed/expanded state
       - subtotal formatted with formatCurrency from utils
       - Muted/secondary text styling for the label, bold for subtotal

    2. Create `apps/web/src/features/accounts/components/AccountListItem.tsx`:
       - Shows account name (left) and balance (right)
       - Balance uses font-mono class for numeric alignment
       - Negative balances get "text-destructive" or "amount-negative" class
       - Hover state with bg-accent transition
       - Active state (when selected) with bg-accent/text-accent-foreground
       - Props: account (AccountResponse), isActive (boolean), onClick (callback), onContextMenu (callback for right-click/... menu)
       - The "..." (more) button appears on hover, triggers onContextMenu

    3. Create `apps/web/src/features/accounts/components/AccountSidebar.tsx`:
       - Takes `accounts: AccountResponse[]` prop and `onAddAccount` callback
       - Uses groupAccounts() utility to organize accounts
       - Renders AccountGroupHeader for each non-empty group
       - Renders AccountListItem under each group
       - "Add Account" button (plus icon) at top of sidebar (subtle, not giant)
       - Sidebar header "Accounts" with the add button
       - Groups are individually collapsible (default: all expanded)
       - Use shadcn Separator between groups
       - If no accounts, renders nothing (EmptyAccountsState handles that in the main area)
       - Bottom of sidebar: dark mode toggle button (preserve existing from DashboardPage)
       - Uses DropdownMenu (already imported from @workspace/ui) for the "..." context menu on each item with Edit and Delete options. Props pass callbacks: onEdit(accountId), onDelete(accountId)

    For now, render with STATIC mock data inline in the component for visual verification. The real data wiring happens in Plan 04.

    Verify: `npx nx typecheck web`
  </action>
  <verify>`npx nx typecheck web` passes.</verify>
  <done>
    AccountSidebar renders grouped accounts with collapsible headers, subtotals, context menus, and polished visual design.
    AccountListItem shows name + balance with hover/active states.
    AccountGroupHeader shows category label + subtotal with collapse/expand toggle.
  </done>
</task>

</tasks>

<verification>
- `npx nx typecheck web` passes
- Empty state component exists with welcome message and Add Account button
- Sidebar component renders grouped accounts with collapsible headers and context menus
- Account grouping utility correctly categorizes all 7 account types
</verification>

<success_criteria>
Visual design of empty state and sidebar complete. Components are polished and ready for functionality wiring.
</success_criteria>

<output>
After completion, create `.planning/phases/15-api-integration-validation/15-02-SUMMARY.md`
</output>
